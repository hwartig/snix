<html>
<head>
  <title></title>
  <script type="text/javascript" src="vendor/jquery-1.7.1.min.js"></script>  
  <script type="text/javascript" src="vendor/underscore.js"></script>
  <script type="text/javascript" src="vendor/moment.min.js"></script>
  <style type="text/css">
    .error {
      border: 1px solid orange;
    }
  </style>
  <!--[if lt IE 9]>
    <script type="text/javascript" src="vendor/json2.js"></script>
  <![endif]-->
  <script type="text/javascript" src="lib/snix.js"></script>
  <script type="text/javascript">
    var User = function(id){
      this.id = Snix.val(id);

      this.release = function(){
        this.id.dispose(true);
      };
    };

    var app = Snix.app(function(s){

      var num = s.compute(function(){
        var u = this.user();

        if(!u)
          return -1;

        return u.id() % 17;
      }, this);

      this.user = s.val(null);

      this.createUsers = function(){
        for(var i=0; i < 2000; i++){
          // if(this.user() != null)
          //   this.user().release();
          this.user(new User(i));
          num();
        }
      };

    });
  </script>
</head>
<body>
  <button data-bind="click: @createUsers()">create users</button>
</body>
</html>
<html>
<head>
  <title></title>
  <script type="text/javascript" src="vendor/jquery-1.7.1.min.js"></script>  
  <script type="text/javascript" src="vendor/underscore.js"></script>
  <script type="text/javascript" src="vendor/moment.min.js"></script>
  <style type="text/css">
    .error {
      border: 1px solid orange;
    }
  </style>
  <!--[if lt IE 9]>
    <script type="text/javascript" src="vendor/json2.js"></script>
  <![endif]-->
  <script type="text/javascript" src="lib/snix.js"></script>
  <script type="text/javascript">
    var app = Snix.app(function(s){
      this.name = s.val("joe");
      this.todos = s.array([
        {id: _.uniqueId(), prio: s.val("high 1")},
        {id: _.uniqueId(), prio: s.val("high 2")},
        {id: _.uniqueId(), prio: s.val("high 3")}
      ]);
      this.selectedTodos = s.array();
      this.selectedTodo = s.val(null);
      this.today = s.val(moment());

      this.loginForm = new function(){
        this.email = s.val("");

        this.validator = s.validator();

        this.exec = function(){

          this.validator.validate({
            email: function(){
              return this.email() != null && this.email().length > 3;
            }
          }, this);

          if(this.validator.isEmpty()){
            console.info("valid");
          }else{
            console.info("invalid");
          }
        };
      };
    });
  </script>
</head>
<body>

  <span data-bind="text: @name"></span>
  <input type="text" data-bind="value: @name"/>
  <a href="#" data-bind="click: @todos.add({id: _.uniqueId(), prio: s.val('bllll')})">create</a>

  <ul data-bind="loop: {entries: @todos, as: 'todo'}">
    <li>
      <span data-bind="text: todo.name"></span>
      <input type="text" data-bind="value: @name"/>
      <span data-bind="text: todo.prio"></span>
      <input type="text" data-bind="value: todo.prio"/>
      <a href="#" data-bind="click: @todos.remove(todo)">delete</a>
    </li>
  </ul>

  <select data-bind="select: {entries: @todos, label: 'prio', selected: @selectedTodos, multiple: true}" size="6"></select>
  <select data-bind="select: {entries: @todos, label: 'prio', selected: @selectedTodo}"></select>


  <h3>selectedTodos</h3>
  <ul data-bind="loop: {entries: @selectedTodos, as: 'todo'}">
    <li>
      <span data-bind="text: todo.name"></span>
      <input type="text" data-bind="value: @name"/>
      <span data-bind="text: todo.prio"></span>
      <input type="text" data-bind="value: todo.prio"/>
      <a href="#" data-bind="click: @todos.remove(todo)">delete</a>
    </li>
  </ul>

  <form>
    <label data-bind="error: @loginForm.validator.field('email')">email</label>
    <input type="text" data-bind="value: @loginForm.email"/>
    <button data-bind="click: @loginForm.exec()">login</button>
  </form>

  <div data-bind="date: {moment: @today}"></div>

</body>
</html>